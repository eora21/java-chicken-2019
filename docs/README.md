# 기능

- [x] 메인 화면
  - [x] 주문등록, 결제하기, 프로그램 종료 선택
- [x] 주문 등록
  - [x] 테이블 목록 보여주기
  - [x] 테이블 선택하기
  - [x] 메뉴 선택하기
  - [x] 메뉴 수량 입력하기
    - [x] 한 메뉴의 최대 수량은 99개
- [ ] 결제하기
  - [x] 테이블 목록 보여주기
  - [x] 테이블 선택하기
  - [x] 주문 내역 보여주기
  - [x] 신용 카드, 현금 선택하기
  - [ ] 최종 결제 금액 보여주기
    - [ ] 치킨들의 수량 합 10개마다 10,000원씩 할인
    - [x] 현금 결제 시 누적 금액에서 5% 추가 할인
- [x] 프로그램 종료
- [x] 주문, 결제 예외 시 이유를 보여준 후 다시 가능토록 해야 함

# 고민

## 주문을 위해 누구와 소통할 것인가

Table과 Menu는 자료형만 구성되어 있었고, 각각의 Repository에는 해당 도메인에 대한 데이터들이 하나의 리스트에 입력되어 있었다.

Enum으로 각각의 데이터들을 객체화하면 편할 것 같았지만, DB에 있는 데이터를 가져와 해당하는 형식을 구성한 상태를 가정하는 것 같았다.

그렇다면 내가 필요한 기능은 도메인이 아닌 Repository와 협력해야 하는 것인지를 고민했다.

예를 들어 한 테이블에서 먹거리를 주문한 경우, 해당 기록을 Repository가 지닌 Table 내에 작성하려 했다. 하지만 과연 이를 Table 도메인 내의 HashMap으로 작성하는게 지금 구조와 비교했을 때 옳은 것인지 생각해 보았다.

객체들과 메시지를 던지는 것만을 생각한다면 괜찮은 방법일 것 같았으나.. 확신이 서지 않았다. `테이블-메뉴`관계를 어디서 짓느냐가 중요한 것 같다.

테이블 내에 메뉴에 관한 내용을 담아둔다면, 이는 테이블과 메뉴과 깊은 관계를 맺게 된다. 따라서 저 둘이 아닌, 테이블과 메뉴 모두를 바라보는 주문 객체를 따로 만들어 둘을 따로 생각할 수 있게끔 하는 것이 좋을 것 같았다.

따라서 Order 클래스를 만든 후 내부에 `테이블-메뉴`관계를 담아둘 수 있도록 했으며, 일급 컬렉션의 역할을 부여하였다.

## main에서 출력을 해도 되는가

MVC의 구조에서는 Controller만 View를 참조할 수 있다. Controller에서 출력을 도맡아야 한다는 뜻이다.

main은 프로그램을 구동시키는 부분인데, try-catch 및 예외사항에 대한 출력을 해도 되는지를 고민했다.

main 또한 main만의 역할과 책임이 있을텐데, 과연 괜찮을까?

우선은 main에서 프로그램의 구동만 책임지기로 작성해보았다.

## Controller, Repository, Service를 나눠 구현한 이유

해당 미션은 Repository를 활용하여 DB의 상태를 확인하는 듯 한 구조이다.

Controller에서는 유저의 엔드포인트를 조절한다. 이 때 Repository의 값을 가져와야 하는데, 이는 사용자와 무관한 내부 동작이므로 Service를 구현했다.

Service는 로직에 맞게 Repository와 협력하며 Controller에서 사용할 값을 반환하도록 했다.

코드를 쪼개다 보니 해당 구조를 갖게 된 것도 있지만, 연습할 겸 작성했다.

### 그렇다면 OrderRepository, OrderService는 왜 작성하지 않았는가

과제 내에서의 Repository는 단순히 DB 데이터를 받아와 정리하는 느낌인데, 주문에 관한 데이터를 만들어 넣고 해당 값들 중 주문 테이블이 일치하는 값들을 모두 불러와 계산하는 방식을 5시간 내에 작성하기 힘들 것 같아 Order 객체에게 메시지를 던지는 방식으로만 작업했다.

# 미구현

## 시간초과

`최종 결제 금액 보여주기`를 작업하던 도중 5시간이 지났다.

## 시간을 뺏긴 부분

메서드 10줄을 신경쓰다가 `예외 시 어디서 반복시킬지`에 대한 생각이 깊어졌다. while + try-catch까지 구현하니 10줄이 빡빡했는데, 그 와중에 사용자가 프로그램 종료를 원한다면 종료까지 시켜줘야했다. 해당 분기를 위해 if문을 작성하니 10줄이 바로 넘어버렸다.

따라서 길이를 줄이기 위해 예외처리 시 코드를 반복시켜주는 핸들러를 작성했다가, 결제하기를 누른 상태에서 틀린 값을 입력하면 계속 결제하기를 반복하는게 불편하다 생각하여 기존 반복문쪽으로 빼왔다. 그랬더니 또 메서드가 10줄을 넘어버려 이리저리 작업하다 main문에서 반복시키는 것을 선택했는데, `과연 main에서 예외사항을 출력해도 될까?`라는 생각때문에 또 코드를 쪼갰다. 물론 생각이 필요한 부분이었으나, 이로 인해 다른 기능을 구현하지 못 하게 되었다.

구현이 끝난 후, 다른 분의 코드를 보다가 내 생각보다 훨씬 좋은 구성의 코드를 보게 되었다. 아, 또 이렇게 하나를 배우는구나. 아직 갈 길이 멀어보인다.

## 생각하지 못 한 부분

`치킨들의 수량 합 10개마다 10,000원씩 할인` 부분을 생각하지 않고 코드를 작성했었다.

물론 최종 결제 시 제외한 값을 적용해도 되나, 기존 주문 내역에서도 보이게 하려면 `Order`쪽에서 신경을 썼어야 했다. 그러나 해당 사항을 깜빡하고 코드를 작성하고 있었다. 이는 분명한 패착이다. 또한, 신경썼다 해도 코드가 내부적으로 많이 지저분했을 것이다. `order`에서 신경쓰는 것 보다 계산 객체를 만들어 사용하는 게 더 나았을 것 같다.